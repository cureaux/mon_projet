name: V√©rification de l'arborescence

on:
  pull_request:
    branches:
      - main

jobs:
  check-arbo:
    name: V√©rification de l'arborescence
    runs-on: ubuntu-latest
    steps:
      - name: Checkout du code
        uses: actions/checkout@v4

      - name: V√©rifier l'arborescence
        run: |
          echo "üìÇ V√©rification de l'arborescence..."
          tree -d
          
          # V√©rifier que les dossiers existent
          if [ ! -d "site" ] || [ ! -d "site/img" ] || [ ! -d "site/css" ] || [ ! -d "site/js" ] || [ ! -d "src" ]; then
            echo "‚ùå Erreur: Certains dossiers sont manquants !"
            exit 1
          fi

          # V√©rifier les extensions
          if find site ! -name "*.html" ! -name "*.php" -type f | grep .; then
            echo "‚ùå Erreur: 'site' ne doit contenir que .html ou .php"
            exit 1
          fi
          if find site/img ! -name "*.png" ! -name "*.jpg" -type f | grep .; then
            echo "‚ùå Erreur: 'img' ne doit contenir que .png ou .jpg"
            exit 1
          fi
          if find site/css ! -name "*.css" -type f | grep .; then
            echo "‚ùå Erreur: 'css' ne doit contenir que .css"
            exit 1
          fi
          if find site/js ! -name "*.js" -type f | grep .; then
            echo "‚ùå Erreur: 'js' ne doit contenir que .js"
            exit 1
          fi

          echo "‚úÖ V√©rification r√©ussie !"
